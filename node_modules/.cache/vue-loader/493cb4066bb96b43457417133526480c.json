{"remainingRequest":"/Users/silan/Desktop/code/code/partTime/wine/svnapp/node_modules/_vue-loader@15.7.2@vue-loader/lib/index.js??vue-loader-options!/Users/silan/Desktop/code/code/partTime/wine/svnapp/src/views/Order.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/silan/Desktop/code/code/partTime/wine/svnapp/src/views/Order.vue","mtime":1574686260542},{"path":"/Users/silan/Desktop/code/code/partTime/wine/svnapp/node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/silan/Desktop/code/code/partTime/wine/svnapp/node_modules/_babel-loader@8.0.6@babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/silan/Desktop/code/code/partTime/wine/svnapp/node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/silan/Desktop/code/code/partTime/wine/svnapp/node_modules/_vue-loader@15.7.2@vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBPcmRlckFkZHJlc3MgZnJvbSAnLi4vY29tcG9uZW50cy9PcmRlckFkZHJlc3MudnVlJwppbXBvcnQgR29vZHNDYXJkIGZyb20gJy4uL2NvbXBvbmVudHMvR29vZHNDYXJkLnZ1ZScKZXhwb3J0IGRlZmF1bHQgewogIGNvbXBvbmVudHM6IHsKICAgIE9yZGVyQWRkcmVzcywKICAgIEdvb2RzQ2FyZAogIH0sCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIGJ0bl9sb2FkaW5nOiBmYWxzZSwKICAgICAgYWxsX251bTogMSwKICAgICAgYWxsX3ByaWNlOiAxMDAwMCwKICAgICAgcG9ja2V0X2NoZWNrOiBmYWxzZSwKICAgICAgdGlja2V0X251bTogNiwKICAgICAgYnV5X251bTogMSwKICAgICAgbW9uZXk6ICcnLAogICAgICB0aXRsZTogJycsCiAgICAgIGFkZHJfaWQ6ICcnLAogICAgICBjb3VudE1vbmV5OjAsCiAgICAgIHBlcmlvZF9pZDogJycsCiAgICAgIGRlc2M6ICcnLAogICAgICBwcmljZTogJycsCiAgICAgIHFiZGs6IDAsCiAgICAgIG1pZFByaWNlOiIiLAogICAgICBzb3VyY2U6ICcnLAogICAgICB0aHVtYjogJycsCiAgICAgIGFjdGl2ZUljb246IHJlcXVpcmUoJy4uL2Fzc2V0cy9pY29ucy9vdGhlci9yYWRpb19jLnBuZycpLAogICAgICBpbmFjdGl2ZUljb246IHJlcXVpcmUoJy4uL2Fzc2V0cy9pY29ucy9vdGhlci9yYWRpby5wbmcnKSwKICAgICAgYWRkcmVzczogewogICAgICAgIG5hbWU6ICcnLAogICAgICAgIG1vYmllOiAnJywKICAgICAgICBhZGRyZXNzOiAnJwogICAgICB9LAogICAgICBvcmRlcldheTogJzEnCiAgICB9CiAgfSwKICB3YXRjaDogewogICAgcG9ja2V0X2NoZWNrKGQpIHsKICAgICAgY29uc29sZS5sb2coZCkKICAgICAgdGhpcy5xYmRrID0gZCA/IDEgOiAwCmlmKGQpewogIC8vIOWPr+aKteaJo+S9memineWPmOWMlgogIHRoaXMuY291bnRNb25leSA9IHRoaXMuYWxsX3ByaWNlPnRoaXMubW9uZXk/dGhpcy5tb25leTp0aGlzLmFsbF9wcmljZQp9ZWxzZXsKICAvLyDlj6/mirXmiaPkvZnpop3lj5jljJYKCnRoaXMuY291bnRNb25leSA9IDA7Cn0KCiAgICAvLyBpZihkKXsKICAgIC8vICAgIHRoaXMuYWxsX3ByaWNlPSBwYXJzZUZsb2F0KHRoaXMuYWxsX3ByaWNlKSAtcGFyc2VGbG9hdCh0aGlzLm1vbmV5KTw9MD8wOnBhcnNlRmxvYXQodGhpcy5hbGxfcHJpY2UpIC1wYXJzZUZsb2F0KHRoaXMubW9uZXkpCiAgICAvLyAgICBpZihwYXJzZUZsb2F0KHRoaXMubW9uZXkpPnBhcnNlRmxvYXQodGhpcy5hbGxfcHJpY2UpKXsKICAgIC8vICAgICAgICAgIHRoaXMuY291bnRNb25leSA9IHRoaXMubWlkUHJpY2UvMTAwCiAgICAvLyAgICB9ZWxzZXsKICAgIC8vIHRoaXMuY291bnRNb25leSA9IHRoaXMuYWxsX3ByaWNlLzEwMAogICAgLy8gICAgfQogICAKICAgIC8vIH1lbHNlewogICAgLy8gICB0aGlzLmFsbF9wcmljZSA9IHRoaXMubWlkUHJpY2UKICAgIC8vICAgdGhpcy5jb3VudE1vbmV5ID0wCiAgICAvLyB9CiAgICB9LAogICAgYnV5X251bShkKSB7CiAgICAgIHRoaXMuYWxsX3ByaWNlID0gZCAqIHRoaXMucHJpY2UKICAgIH0sCiAgICBtb25leUdyYWRlKGQpIHsKICAgICAgdGhpcy5tb25leSA9IGQubW9uZXkKICAgIH0sCiAgICAvL+WcsOWdgAogICAgYWRkckxpc3QoZCkgewogICAgICBpZiAoZC5sZW5ndGggPiAwKSB7CiAgICAgICAgLy8g6I635Y+W6buY6K6k5Zyw5Z2ACiAgICAgICAgbGV0IGFyciA9IGQubWFwKGl0ZW0gPT4gaXRlbS5kZWZhdWx0ICYmIGl0ZW0pCiAgICAgICAgLy8gIOayoeaciem7mOiupOWcsOWdgCzojrflj5bnrKzkuIDkuKoKICAgICAgICBpZiAoYXJyLmxlbmd0aCA9PT0gMCkgewogICAgICAgICAgYXJyID0gZFswXQogICAgICAgIH0KCiAgICAgICAgdGhpcy5hZGRyZXNzID0gYXJyWzBdCiAgICAgICAgdGhpcy5hZGRyX2lkID0gdGhpcy5hZGRyZXNzLmlkCiAgICAgIH0gZWxzZSB7CiAgICAgICAgLy8g5rKh5pyJ5Zyw5Z2ACiAgICAgIH0KICAgIH0sCiAgICBjcmVhdGVPcmRlcihkKXsKICAgICAgY29uc29sZS5sb2coZCkKICAgaWYoZC50b3BheSl7CiAgICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSBkLnRvcGF5KycmYmFja3VybD1odHRwczovL2poaHkudnNhcHAuY24vaDUvIy9tZScKICAgfQogICAgfSwKICB9LAogIG1ldGhvZHM6IHsKICAgIC8vIOaUr+S7mAogICAgc3VibWl0UGF5KCkgewogICAgICBsZXQgewogICAgICAgIG9yZGVyX251bSwKICAgICAgICBnb29kc19pZCwKICAgICAgICBhdHRyX2lkLAogICAgICAgIGJ1eV9udW0sCiAgICAgICAgcWJkaywKICAgICAgICBhZGRyX2lkLAogICAgICAgIHBlcmlvZF9pZCwKICAgICAgICBzb3VyY2UKICAgICAgfSA9IHRoaXMKICAKICAgICAgdGhpcy4kc3RvcmUuZGlzcGF0Y2goJ2NyZWF0ZU9yZGVyJyx7CiAgICAgICAgICBvcmRlcl9udW0sCiAgICAgICAgZ29vZHNfaWQsCiAgICAgICAgYXR0cl9pZCwKICAgICAgICBidXlfbnVtLAogICAgICAgIHFiZGssCiAgICAgICAgYWRkcl9pZCwKICAgICAgICBwZXJpb2RfaWQsCiAgICAgICAgc291cmNlCiAgICAgIH0pCgogICAgfSwKICAgIHF1ZXJ5QWRkckxpc3QoKSB7CiAgICAgIHRoaXMuJHN0b3JlLmRpc3BhdGNoKCdnZXRBZGRyTGlzdCcpCiAgICB9LAogICAgZ2V0UGFyYW1zKCkgewogICAgICBsZXQgewogICAgICAgIHNvdXJjZSwKICAgICAgICBnb29kc19pZCwKICAgICAgICBwcmljZSwKICAgICAgICBwZXJpb2RfaWQsCiAgICAgICAgYXR0cl9pZCwKICAgICAgICBuYW1lLAogICAgICAgIGRscV9hZGRfbnVtcywKICAgICAgICBkbHFfbmVlZF9udW1zLAogICAgICAgIGltZywKICAgICAgICBnb29kc19uYW1lLAogICAgICAgIGJ1eV9udW0sCiAgICAgICAgb3JkZXJfbnVtCiAgICAgIH0gPSB0aGlzLiRyb3V0ZS5xdWVyeQogICAgICB0aGlzLnRpdGxlID0gZ29vZHNfbmFtZQogICAgICB0aGlzLmRlc2MgPSBg5bqm5pWw77yaJHtuYW1lfWAKICAgICAgdGhpcy5wcmljZSA9IHByaWNlCiAgICAgIC8vIHRoaXMubnVtID0gYnV5X251bQogICAgICB0aGlzLmJ1eV9udW0gPSBidXlfbnVtCiAgICAgIHRoaXMudGh1bWIgPSBpbWcKICAgICAgdGhpcy50aWNrZXRfbnVtID0gZGxxX25lZWRfbnVtcyB8fCBkbHFfYWRkX251bXMKICAgICAgdGhpcy5hbGxfcHJpY2UgPSBwcmljZSAqIGJ1eV9udW0KICAgICAgdGhpcy5taWRQcmljZSA9IHRoaXMuYWxsX3ByaWNlCiAgICAgIHRoaXMuc291cmNlID0gc291cmNlCiAgICAgIHRoaXMuZ29vZHNfaWQgPSBnb29kc19pZAogICAgICB0aGlzLnBlcmlvZF9pZCA9IHBlcmlvZF9pZAogICAgICB0aGlzLmF0dHJfaWQgPSBhdHRyX2lkCiAgICAgIHRoaXMub3JkZXJfbnVtID0gb3JkZXJfbnVtCiAgICB9LAogICAgLy8g6I635Y+W5oiR55qE6ZKx5YyFCiAgICBnZXRNb25leUdyYWRlKCkgewogICAgICB0aGlzLiRzdG9yZS5kaXNwYXRjaCgnZ2V0TW9uZXlHcmFkZScpCiAgICB9CiAgfSwKICBjb21wdXRlZDogewogICAgYWRkckxpc3QoKSB7CiAgICAgIHJldHVybiB0aGlzLiRzdG9yZS5zdGF0ZS5hZGRyTGlzdAogICAgfSwgLy8g5oiR5b6X6ZKx5YyFCiAgICBtb25leUdyYWRlKCkgewogICAgICByZXR1cm4gdGhpcy4kc3RvcmUuc3RhdGUubW9uZXlHcmFkZQogICAgfSwKICAgIGNyZWF0ZU9yZGVyKCl7CiAgICAgIHJldHVybiB0aGlzLiRzdG9yZS5zdGF0ZS5jcmVhdGVPcmRlcgogICAgfSwKICB9LAoKICBtb3VudGVkKCkgewogICAgdGhpcy5nZXRQYXJhbXMoKQogICAgLy8g5Zyw5Z2A5YiX6KGoCiAgICB0aGlzLnF1ZXJ5QWRkckxpc3QoKQogICAgLy8g6ZKx5YyFCiAgICB0aGlzLmdldE1vbmV5R3JhZGUoKQogIH0KfQo="},{"version":3,"sources":["Order.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAkDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Order.vue","sourceRoot":"src/views","sourcesContent":["<template>\n  <div class=\"order_container\">\n    <Gheader title=\"确认订单\" back=\"1\" />\n\n    <div class=\"pad_container\">\n      <!-- 地址 -->\n<router-link  to=\"/myAddr\" tag=\"div\" >\n    <OrderAddress :address=\"address\" v-if=\"Object.keys(address).length\"/>\n      <div class=\"addAddr\" v-else>\n      添加地址\n       <van-icon name=\"arrow\" />\n         </div>\n</router-link>\n    \n    \n      <!-- 购物车 -->\n      <div class=\"card\">\n        <!-- 商品图 -->\n        <GoodsCard :num=\"buy_num\" :price=\"parseFloat(price)/100\" :desc=\"desc\" :title=\"title\" :thumb=\"thumb\" />\n        <!-- 购买数量 -->\n        <div class=\"step\">\n          <p>购买数量</p>\n          <van-stepper v-model=\"buy_num\" button-size=\"22px\" />\n        </div>\n        <div class=\"ticket\">\n          <p>需要代理资格券</p>\n          <p class=\"ticket_num\">{{ticket_num}}张</p>\n        </div>\n      </div>\n      <!-- 钱包抵扣 -->\n\n      <div class=\"pocket flex_bet\">\n        <div class=\"flex\">\n          <van-checkbox v-model=\"pocket_check\" shape=\"square\" checked-color=\"#E70002\">钱包余额</van-checkbox>\n          <p class=\"money\">(余额￥{{formatPrice(money)}})</p>\n        </div>\n        <p class=\"ticket_num small\">可抵扣￥{{formatPrice(countMoney)}}</p>\n      </div>\n      <!-- 付款 -->\n      <div class=\"footer\">\n        <p>\n          共 {{buy_num}} 件，合计\n          <b>￥{{parseFloat(all_price)/100}}</b>\n        </p>\n        <van-button type=\"default\" :loading=\"btn_loading\" loading-text=\"提交中..\" @click=\"submitPay\">付款</van-button>\n      </div>\n    </div>\n  </div>\n</template>\n<script>\nimport OrderAddress from '../components/OrderAddress.vue'\nimport GoodsCard from '../components/GoodsCard.vue'\nexport default {\n  components: {\n    OrderAddress,\n    GoodsCard\n  },\n  data() {\n    return {\n      btn_loading: false,\n      all_num: 1,\n      all_price: 10000,\n      pocket_check: false,\n      ticket_num: 6,\n      buy_num: 1,\n      money: '',\n      title: '',\n      addr_id: '',\n      countMoney:0,\n      period_id: '',\n      desc: '',\n      price: '',\n      qbdk: 0,\n      midPrice:\"\",\n      source: '',\n      thumb: '',\n      activeIcon: require('../assets/icons/other/radio_c.png'),\n      inactiveIcon: require('../assets/icons/other/radio.png'),\n      address: {\n        name: '',\n        mobie: '',\n        address: ''\n      },\n      orderWay: '1'\n    }\n  },\n  watch: {\n    pocket_check(d) {\n      console.log(d)\n      this.qbdk = d ? 1 : 0\nif(d){\n  // 可抵扣余额变化\n  this.countMoney = this.all_price>this.money?this.money:this.all_price\n}else{\n  // 可抵扣余额变化\n\nthis.countMoney = 0;\n}\n\n    // if(d){\n    //    this.all_price= parseFloat(this.all_price) -parseFloat(this.money)<=0?0:parseFloat(this.all_price) -parseFloat(this.money)\n    //    if(parseFloat(this.money)>parseFloat(this.all_price)){\n    //          this.countMoney = this.midPrice/100\n    //    }else{\n    // this.countMoney = this.all_price/100\n    //    }\n   \n    // }else{\n    //   this.all_price = this.midPrice\n    //   this.countMoney =0\n    // }\n    },\n    buy_num(d) {\n      this.all_price = d * this.price\n    },\n    moneyGrade(d) {\n      this.money = d.money\n    },\n    //地址\n    addrList(d) {\n      if (d.length > 0) {\n        // 获取默认地址\n        let arr = d.map(item => item.default && item)\n        //  没有默认地址,获取第一个\n        if (arr.length === 0) {\n          arr = d[0]\n        }\n\n        this.address = arr[0]\n        this.addr_id = this.address.id\n      } else {\n        // 没有地址\n      }\n    },\n    createOrder(d){\n      console.log(d)\n   if(d.topay){\n        window.location.href = d.topay+'&backurl=https://jhhy.vsapp.cn/h5/#/me'\n   }\n    },\n  },\n  methods: {\n    // 支付\n    submitPay() {\n      let {\n        order_num,\n        goods_id,\n        attr_id,\n        buy_num,\n        qbdk,\n        addr_id,\n        period_id,\n        source\n      } = this\n  \n      this.$store.dispatch('createOrder',{\n          order_num,\n        goods_id,\n        attr_id,\n        buy_num,\n        qbdk,\n        addr_id,\n        period_id,\n        source\n      })\n\n    },\n    queryAddrList() {\n      this.$store.dispatch('getAddrList')\n    },\n    getParams() {\n      let {\n        source,\n        goods_id,\n        price,\n        period_id,\n        attr_id,\n        name,\n        dlq_add_nums,\n        dlq_need_nums,\n        img,\n        goods_name,\n        buy_num,\n        order_num\n      } = this.$route.query\n      this.title = goods_name\n      this.desc = `度数：${name}`\n      this.price = price\n      // this.num = buy_num\n      this.buy_num = buy_num\n      this.thumb = img\n      this.ticket_num = dlq_need_nums || dlq_add_nums\n      this.all_price = price * buy_num\n      this.midPrice = this.all_price\n      this.source = source\n      this.goods_id = goods_id\n      this.period_id = period_id\n      this.attr_id = attr_id\n      this.order_num = order_num\n    },\n    // 获取我的钱包\n    getMoneyGrade() {\n      this.$store.dispatch('getMoneyGrade')\n    }\n  },\n  computed: {\n    addrList() {\n      return this.$store.state.addrList\n    }, // 我得钱包\n    moneyGrade() {\n      return this.$store.state.moneyGrade\n    },\n    createOrder(){\n      return this.$store.state.createOrder\n    },\n  },\n\n  mounted() {\n    this.getParams()\n    // 地址列表\n    this.queryAddrList()\n    // 钱包\n    this.getMoneyGrade()\n  }\n}\n</script>\n<style scoped>\n.addAddr{\n  background: #fff;\n  padding: .4rem ;\nbox-sizing: border-box;\ndisplay: flex;\njustify-content: space-between;\nalign-items: center;\n}\n.order_container {\n  font-size: 0.4rem;\n}\n.way {\n  background: #fff;\n  padding: 0.3rem 1rem;\n  box-sizing: border-box;\n}\n.way p {\n  color: #666;\n}\n.way_checkbox {\n  display: flex;\n\n  align-items: center;\n  margin: 0.3rem 0;\n}\n.way_checkbox .van-radio {\n  margin-right: 0.5rem;\n}\n.icon {\n  width: 0.5rem;\n}\n.card {\n  box-shadow: 0px 0.0267rem 0.08rem 0px rgba(0, 0, 0, 0.15);\n  border-radius: 0.2rem;\n  overflow: hidden;\n  background: #fff;\n  margin: 0.2rem 0;\n}\n\n.step {\n  margin: 0 auto;\n  margin-top: 0.2rem;\n  padding: 0.5rem 0;\n  width: 8.8rem;\n  box-sizing: border-box;\n  display: flex;\n  justify-content: space-between;\n  border-top: 1px solid #e3e3e3;\n}\n.ticket {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  width: 8.8rem;\n  margin: 0 auto;\n  margin-bottom: 0.3rem;\n  font-size: 0.3733rem;\n}\n.ticket_num {\n  color: #d2d2d2;\n  max-width: 3.4rem;\n}\n.pocket {\n  background: #fff;\n  padding: 0.5rem 0.3rem;\n  box-shadow: 0px 0.0267rem 0.08rem 0px rgba(0, 0, 0, 0.15);\n  border-radius: 0.2rem;\n}\n.money {\n  margin-left: 0.2rem;\n  font-size: 0.3467rem;\n}\n.footer {\n  background: #fff;\n  position: fixed;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  width: 10rem;\n  margin: auto;\n  display: flex;\n  height: 1.6rem;\n  align-items: center;\n  justify-content: space-around;\n  box-shadow: 0px 2px 6px 0px rgba(0, 0, 0, 0.15);\n}\nb {\n  font-size: 0.5333rem;\n  color: #e70002;\n}\n.van-button--default {\n  color: #fff;\n  background-image: url('../assets/icons/home/buy.png');\n  background-repeat: no-repeat;\n  background-size: 100%;\n  background-position: center;\n  background-color: transparent;\n  border: none;\n  width: 3.5rem;\n  padding-left: 0.1rem;\n}\n.van-button__text {\n  color: #fff;\n}\n.small {\n  font-size: 0.3rem;\n}\n</style>"]}]}